// ==UserScript==
// @name         实验室安全考试自动答题 & 题库提取脚本 v3.0
// @namespace    http://tampermonkey.net/
// @version      3.0
// @description  在答题页自动答题；在答卷查看页自动提取新题和错题，一键更新题库。
// @author       Gemini
// @match        *://labsafetest.uestc.edu.cn/*
// @grant        GM_setClipboard
// ==/UserScript==

(function() {
    'use strict';

    // --- 题库数据 ---
    // 将您所有的题库都粘贴在这里
// --- 题库数据 (最终修正版 v2.1) ---
    const questionBank = {
        "触电时，不可人去拉（可用木棒把伤员挑开），应立即切断电源，然后先做人工呼吸，再做心脏按压，同时报120送医院进行处理。": "正确",
        "如遇刺激性及神经性中毒，先服牛奶或鸡蛋白使之缓和，再服用硫酸铜溶液（30g溶于一杯水中）催吐。也可以用手指伸入喉部催吐后，立即送往医院。": "正确",
        "交流电路断电后，内部的电容可能会：": "D",
        "引发电气火灾的初始原因是:": "C",
        "低压电笔一般适用于多少?V?以下的交流电压？": "C",
        "漏电保护器可防止：": "A",
        "使用离心机时下列哪种操作是错误的？": "B",
        "以下哪项不属于死亡的特征?": "A",
        "易燃、易爆物品和杂物等应该堆放在：": "C",
        "实验室存放化学品不得使用哪类冰箱？": "A",
        "不会发生爆炸的是：": "B",
        "预防电击（触电）的一条重要措施是用电设备的金属外壳要有效接地。请从下列选项中选择可靠的接地点：": "C",
        "能相互反应产生有毒气体的废液，应：": "C",
        "数控电火花线切割机床在正常加工时，突然有烧焦气味从机床电器柜中传出，应采取哪种处理措施？": "D",
        "窒息灭火法是将氧气浓度降低至最低限度，以防止火势继续扩大。其主要工具是：": "C",
        "干粉灭火器适用于：": "D",
        "进行较剧烈的体育锻炼如球类比赛、快速跑、健美操等，运动后应多补充一些碱性食物，如：": "A",
        "傍晚锻炼结束与睡觉的间隔时间要在多少时间以上，否则，会影响夜间的休息？": "B",
        "如遇呼吸道吸进有毒气体、蒸气、烟雾而引起呼吸系统中毒时，应立即将病人移至室外空气新鲜的地方，解开衣领，使之温暖和安静，切勿随便进行人工呼吸。": "正确",
        "如遇刺激性及神经性中毒，先服牛奶或鸡蛋白使之缓和，再服用硫酸铜溶液（30g溶于一杯水中）催吐。也可以用手指伸入喉部催吐后，立即送往医院。": "错误",
        "消防车和消火栓的颜色是：": "C",
        "由于行为人的过失引起火灾，造成严重后果的行为，构成（ ）": "B",
        "在附近无水源，身上着火来不及脱衣服时，应就地打滚，将火苗压灭进行自救。": "正确",
        "安装刀具时，要正确使用扳手，并防止扳手滑脱伤人。": "正确",
        "生物实验中的一次性手套及沾染EB致癌物质的物品，可以丢弃在普通垃圾箱内。": "错误",
        "安全事故处理应本着先人后物的原则，果断地、坚决地快速处置。": "正确",
        "身边没有胶水胶棒时可以用口舔标签用以粘贴。": "错误",
        "触电紧急救护时，首先应使触电者脱离电源，然后立即进行人工呼吸、心脏按压。": "正确",
        "溅入口中已下咽的强酸，先饮用大量水，再服用氢氧化铝膏，鸡蛋清。": "正确",
        "加强对实验动物管理工作，防止人畜共患病和动物传染病的发生，是搞好生物安全管理工作的根本目标。": "正确",
        "电炉、烘箱等用电设备在使用中，使用人员不得离开。": "正确",
        "电气设备和大型仪器须接地良好，对电线老化等隐患要定期检查并及时排除。": "正确",
        "发生意外后先对伤员进行必要的止血、包扎、固定等处理，然后尽可能用担架搬运，搬运时病人始终处脚朝前，头朝后，以便于随时观察伤者情况变化，及时实施急救处理。": "正确",
        "某人因机械操作不慎，致使左手食指从指根完全离断，急救处理首先是找器皿保存断指，然后包扎残端伤口止血。": "错误",
        "与工作无关的外来人员不得进入实验室。": "正确",
        "对于触电事故，应立即切断电源或用有绝缘性能的木棍棒挑开和隔绝电流，如果触电者的衣服干燥，又没有紧缠住身上，可以用一只手抓住他的衣服，拉离带电体；但救护人不得接触触电者的皮肤，也不能抓他的鞋。": "正确",
        "大火封门无路可逃时，可用浸湿的被褥、衣物堵塞门缝，向门上泼水降温，以延缓火灾蔓延时间，呼叫待援。": "正确",
        "水具有导电性，不宜扑救带电设备的火灾，不能扑救遇水燃烧物质或非水溶性燃烧液体的火灾。": "正确",
        "引发电气火灾的初始原因：": "C",
        "自耦电源变压器的输出端指示电压为零时，表示：": "C",
        "下列哪些是预防电气火灾的基本措施？": "D",
        "在进行电子线路板焊接后的剪脚工序时应：": "A",
        "任何电气设备在未验明无电之前，一律认为：": "C",
        "车床开动以后：": "A",
        "实验大楼因出现火情发生浓烟已穿入实验室内时，以下哪种行为是正确的？": "B",
        "身上着火，最好的做法是：": "A",
        "进行照明设施的接电操作，应采取的防触电措施为：": "B",
        "节假日期间，仍然需要进入实验室工作的师生，要严格遵守实验室操作规程，做实验时必须要有人在场，并且在实验完成离开时负责       ，锁好门窗，以防火灾和爆炸、溢水等事故。": "B",
        "实验室钥匙不得私自配置或给他人使用。钥匙的配发、管理由谁负责？": "A",
        "实验室内         。": "C",
        "实验室各种管理规章制度应该：": "A",
        "每次进行体育锻炼的时间一般以30分钟至多少小时为宜？": "A",
        "在体育锻炼时或体育锻炼后即刻，立即测10秒钟的心率和脉搏，就一般体育锻炼者来说，运动后即刻的心率最好不要超过多少次/10秒？": "C",
        "《中华人民共和国消防法》自（ ）起施行。": "B",
        "电线接地时，人体距离接地点越近，跨步电压越高；距离越远，跨步电压越低。一般情况下距离接地体多少，跨步电压可看成是零？": "B",
        "三相电闸闭合后或三相空气开关闭合后，三相电机嗡嗡响、不转或转速很慢。为什么？": "C",
        "使用干燥箱和恒温箱，应注意的事项有：": "D",
        "化学强腐蚀烫、烧伤事故发生后，应       ，保持创伤面的洁净以待医务人员治疗。或用适合于消除这类化学药品的特种溶剂、溶液仔细洗涤烫、烧伤面。": "B",
        "以下止血方法中,哪种不作为首选应用?": "D",
        "加热和蒸馏有易燃试剂的实验时，不能用：": "B",
        "为避免误食有毒的化学药品，以下说法正确的是：": "C",
        "违反《中华人民共和国消防法》行为，构成犯罪的，应：": "B",
        "灭火的四种方法是：": "C",
        "任何单位（ ）都有参加组织的灭火工作的义务。": "B",
        "火灾初起阶段是扑救火灾( )的阶段。": "B",
        "学校教学楼应配备的灭火器型号是（ ）": "A",
        "实验中遇到一般割伤，应立即取出伤口内的异物，保持伤口干净，并用酒精棉清除伤口周围的污物，涂上外伤膏或消炎粉。": "错误",
        "实施急救的顺序：若有呼吸心跳停止的，先行复苏，然后是止血、包扎、骨折固定或脱臼复位（固定）、搬运。": "正确",
        "剧毒品的标识是:": "正确",
        "电离辐射（放射性）的警告标识是:": "正确",
        "实验室安全与卫生工作应坚持“安全第一，预防为主”的原则。": "正确",
        "不得在冰箱、烘箱等加热、产热设备附近放置纸板、化学试剂、气体钢瓶等物品。": "正确",
        "因为实验需要，可以在实验室存放大量气体钢瓶。": "错误",
        "可将食物储藏在实验室的冰箱或冷柜内。": "错误",
        "使用手提灭火器时，拨掉保险销，握住胶管前端， 对准燃烧物根部用力压下压把，灭火剂喷出，左右扫射，就可灭火。": "正确",
        "实验大楼出现火情时千万不要乘电梯，因为电梯可能因停电或失控，同时又因“烟囱效应”，电梯井常常成为浓烟的 流通道。": "正确",
        "电气设备着火，首先必须采取的措施是灭火。": "错误",
        "焊接场地在10米内，禁止堆放易燃和易爆物质。": "正确",
        "在钻床上工作时，如果钻头上缠有长铁屑，可用手拉断。": "错误",
        "任何电气设备在未验明无电时，一律认为有电，不能盲目触及。": "正确",
        "实验中遇到一般烫伤和烧伤，不要弄破水泡，在伤口处用95%的酒精轻涂伤口，涂上烫伤膏或涂一层凡士林油，再用纱布包扎。": "错误",
        "机器仪表发生故障，或机器及动力装备等遇异状时，应该先关机，然后找有关人员前来检修,并设立警示牌。": "正确",
        "在钻床上工作时，为保护双手，可以戴手套进行工作。": "错误",
        "电路谐振时，电容的电压可以是电源电压的几倍。": "正确",
        "短路会使短路处甚至整个电路过热，从而导致线路的绝缘层燃烧，引发火灾。": "正确",
        "灭火器材设置点附近不能堆放物品,以免影响灭火器的取用。": "正确",
        "发现火灾时，单位或个人应该先自救，当自救无效、火越着越大时，再拨打火警电话119。": "错误",
        "在实验室同时使用多种电气设备时，其总用电量和分线用电量均应小于设计容量。": "正确",
        "短路是指电气线路中相线与相线，相线与零线或大地，在未通过负载或电阻很小的情况下相碰，造成电气回路中电流剧增的现象。": "正确",
        "在有爆炸和火灾危险场所使用手持式或移动式电动工具时，必须采用有防爆措施的电动工具。": "正确",
        "保险丝和空气开关可以有效地防止电气火灾。": "正确",
        "实验室禁止私拉乱接电线，实验过程中自制非标设备时，应报请实验室管理人员批准，然后请电气专业人员按照标准安全的连接。": "正确",
        "电动工具的电源引线必须保证接地可靠。": "正确",
        "电路保险丝熔断，短期内可以用铜丝或铁丝代替。": "错误",
        "当手、脚或身体沾湿或站在潮湿的地板上时，切勿启动电源开关和触摸电气用具。": "正确",
        "身边有人严重触电，应当首先切断电源，然后进行紧急抢救如人工呼吸，并立即拨打急救电话120。": "正确",
        "金属材料可以很好地屏蔽低频磁场。": "错误",
        "漏电保护器既可用来保护人身安全，还可用来对低压系统或设备的绝缘状况起到监督作用；漏电保护器安装点以后的线路应是对地绝缘良好。": "正确",
        "为了防止触电可采用绝缘、防护、隔离等技术措施以保障安全。": "正确",
        "电动工具应定期检修。": "正确",
        "电磁式电流互感器在使用中付边不许开路，电压互感器在使用中付边不许短路。": "正确",
        "对容易产生静电的场所，要保持空气潮湿；工作人员要穿防静电的衣服和鞋靴。?": "正确",
        "打开含有高压变压器或电容器的电子仪器的盖子是危险的。": "正确",
        "连接电气设备的开关需安装在火线上。": "正确",
        "在潮湿或高温或有导电灰尘的场所，实验时应该降低电压供电。": "正确",
        "电气检修时,应在配电箱或开关处悬挂“禁止合闸，有人工作”的标示牌。": "正确",
        "高速设备和精密设备应在管理人员指导下使用。": "正确",
        "在进行电子线路板焊接后的剪脚工序时，剪脚面应背离身体特别是脸部，防止被剪下引脚弹伤。": "正确",
        "电流对人体的伤害有两种类型：即电击和电伤。": "正确",
        "静电可以引起爆炸、电气绝缘和电子元器件击穿。": "正确",
        "实验室内应使用空气开关并配备必要的漏电保护器；电气设备应配备足够的用电功率和电线，不得超负荷用电；电气设备和大型仪器须接地良好，对电线老化等隐患要定期检查并及时排除。": "正确",
        "所有的火灾刚开始时都是小火，随着火灾的发展输出的热量越大，火灾蔓延的速度和范围也愈大，所以扑灭初起火灾 最容易的。": "正确",
        "液体着火时，应用灭火器灭火，不能用水扑救或其 它物品扑打。": "正确",
        "岗位消防安全“四知四会”中的“四会”是指：会报警，会使用消防器材，会扑救初期火灾，会逃生自救": "正确",
        "万一发生了火灾，不管是否是电气方面引起的，首先要想办法迅速切断火灾范围内的电源。": "正确",
        "若宿舍门外已被大火封死，要紧闭房门，用湿毛巾 等堵塞门缝，在室内等待救援。": "正确",
        "在扑灭电气火灾的明火时，用气体灭火器扑灭。": "正确",
        "扑救气体火灾切忌盲目扑灭火势，首先应切断火势蔓延途径，然后疏散火势中压力容器或受到火焰辐射热威胁的压力 容器，不能疏散的部署水枪进行冷却保护。": "正确",
        "在熟睡时，听到火警信号后正确的做法是：1、用手试一试门是否热，如是冷的，可开门逃生；2、准备好湿毛巾；3、切勿随意跳楼，自制救生绳索后再设法安全着落；4、利用自然条件作为救生滑道。": "正确",
        "同学发现宿舍楼的电闸箱起火，可以用楼内的消火栓灭火。": "错误",
        "负载处于工作状态时，可以插、拔、接电气线路。": "错误",
        "火灾发生后，当所有的逃生线路被大火封锁时，应立即退回室内，用手电筒、挥舞衣物、呼叫等方式向窗外发送求救 信号，等待救援。": "正确",
        "浇注期间，其他同学不用让开通道，或可站在身旁观看。": "错误",
        "《中华人民共和国传染病防治法》由中华人民共和国第十届全国人民代表大会常务委员会第十一次会议于2004年8月28日修订通过。": "正确",
        "可以用潮湿的手碰开关、电线和电器。": "错误",
        "化学类实验室原则上不得使用明火电炉。确须使用明火电炉进行实验的，须向实验室与设备处申报，经审核批准备案后，方可使用。": "正确",
        "实验室应保持整洁有序，不准喧哗、打闹、抽烟。": "正确",
        "废弃的利器(包括针头、小刀、金属和玻璃等)应直接弃置于耐扎容器内。": "正确",
        "实验结束后，要关闭设备，断开电源，并将有关实验用品整理好。": "正确",
        "实验室发生非火灾类事故，应立即报告单位负责人和学校保卫处，设立警戒区并撤离无关人员，以减轻潜在危害。": "正确",
        "学生进入实验室首先要了解实验室的安全注意事项。": "正确",
        "在使用高压灭菌锅、烤箱等高压加热设备时，必须有人值守。": "正确",
        "易燃、易爆气体和助燃气体（氧气等）的钢瓶不得混放在一起，并应远离热源和火源，保持通风。": "正确",
        "高校实验室科研教学活动中产生和排放的废气、废液、固体废物、噪声、放射性等污染物，应按环境保护行政主管部门的要求进行申报登记、收集、运输和处置。严禁把废气、废液、废渣和废弃化学品等污染物直接向外界排放。": "正确",
        "未经允许不得随意拆卸实验仪器和设备。": "正确",
        "使用电子门禁的大楼和实验室，应对各类人员设置相应的级别，对于门禁卡丢失、人员调动或离校等情况应及时采取措施，办理报失或移交手续。": "正确",
        "火或热水等引起的小面积烧伤、烫伤，必须用冷水冲洗30分钟以上，然后用烧伤膏涂抹，切不可用牙膏、酱油、盐等覆盖。": "正确",
        "当有人发生触电事故时，应马上直接将其拉开。": "错误",
        "手工锻造时，握钳者应将钳把置于体侧，不得正对腹部，或将手放入钳股之间。": "正确",
        "燃烧必须具备可燃物、助燃物和点火源三大条件，缺一不可。因此，可以采取尽量隔离的方式来防止实验室火灾的发生。": "正确",
        "电气设备发生火灾时，应注意：1、电气设备可能带电，可能发生触电事故；2、某些电气设备充有大量的油，可能发生喷油甚至爆炸。": "正确",
        "消防队在扑救火灾时，有权根据灭火的需要，拆除或者破损临近火灾现场的建筑。": "正确",
        "锻压过程中，不锤击时，脚可一直踩在踏杆上。": "错误",
        "体育锻炼的负荷量无论是强度、时间还是密度都要因人、因时而异，应根据自身的实际情况安排运动负荷。": "正确",
        "血压升高，目光无神，情绪烦躁，面色苍白等，如果是因锻炼造成的，则都是运动不足的征兆。": "错误",
        "以下情况不宜进行游泳锻炼：患心脏病、高血压、肺结核和身体虚弱的人；严重沙眼、传染性皮肤病、细菌性肠炎等人；病刚好或发烧头疼、伤风感冒、过度疲劳、饥饿时；饭后45—60分钟和剧烈运动后不久；女生月经期不宜下水。": "正确",
        "从自己的实际情况出发，锻炼要循序渐进，不要急于求成，应做自己力所能及的动作。锻炼时间不宜过长，练习负荷不宜过重，以免过度疲劳或发生运动损伤。": "正确",
        "病原微生物的研究工作必须在生物安全一级（BSL－1）、二级（BSL－2）、三级（BSL－3）和四级（BSL－4）实验室中进行。": "正确",
        "加强计算机的安全管理，建立病毒防护系统并不断加以更新，重要的数据资料应定期进行备份。": "正确",
        "有“严禁烟火”警示牌的大楼和实验室，可不必配置必要的消防、冲淋、洗眼、报警和逃生设施和有明显标志。": "错误",
        "及时淘汰老化、性能不稳又具有安全隐患的仪器设备（如冰箱10年以上，烘箱12年以上）。": "正确",
        "公共场所安全出口的疏散门应（ ）。": "B",
        "有机物或能与水发生剧烈化学反应的药品着火，应用 （ ），以免扑救不当造成更大损害。": "C",
        "从下列选项中选择万一发生电气火灾后首先应该采取的第一条措施": "B",
        "我国大陆通用的火警电话号码是：": "B",
        "实验室电器发生火灾，在没有灭火器的情况下应先：": "C",
        "公安消防队救火（）": "C",
        "发生火灾时，正确的安全疏散主要有三个方向，向下可以跑到地面，向上可以爬到屋顶，还可以（）": "B",
        "可以用水扑灭的火灾是下列哪种物质？": "D",
        "我国消防宣传活动日是每年的": "A",
        "楼内失火应( )": "A",
        "在室外灭火时，应站在什么位置 ？": "A",
        "化学药品存放室要有防盗设施，保持通风，试剂存放应：": "A",
        "我国消防工作的方针是：": "C",
        "泡沫灭火器不能用于扑救 （ ）火灾。": "C",
        "实验室仪器设备用电或线路发生故障着火时，应立即（ ），并组织人员用灭火器进行灭火。": "B",
        "如果睡觉时被烟火呛醒，正确的做法是（）。": "A",
        "使用灭火器扑救火灾时要对准火焰的什么部位喷射。": "C",
        "实验室生物安全等级分四级，哪级生物安全防护要求最高？": "D",
        "诱发安全事故的原因是：": "D",
        "实验中溅入口中已下咽的强碱，先饮用大量水，再服用：": "B",
        "有人触电时，使触电人员脱离电源的错误方法是：": "B",
        "有机物或能与水发生剧烈化学反应的药品着火，应用       ，以免扑救不当造成更大损害。": "C",
        "药品中毒的途径有哪些？": "D",
        "使用办公自动化设备时，应当遵守下列规定：": "D",
        "用于饲养实验动物或进行动物实验的设施或部门，必须具备什么证明？": "B",
        "车间内的插座距地面的高度一般不低于多少米?": "A",
        "金属梯子不适于以下什么工作场所?": "A",
        "如果实验出现火情，要立即：": "A",
        "实验室电器设备所引起的火灾，应：": "B",
        "锻造过程中，对站立位置有何要求：": "A",
        "公安消防人员在灭火过程中，应当（ ）。": "A",
        "扑救电气设备火灾时，不能用什么灭火器?": "C",
        "火灾中对人员威胁最大的是（ ）。": "B",
        "火场逃生的原则是 ( ) 。": "C",
        "当打开房门闻到燃气气味时，要迅速( )，以防止引起火灾。": "B",
        "在有电阻、电容、电感的电路中，电源电压是几十伏，电容或电感的电压可以是：": "C",
        "安装使用漏电保护器，是属于哪种安全技术措施?": "A",
        "工作地点相对湿度大于?75%?时，属于什么环境？": "A",
        "强电实验时，实验人员必须几人以上？": "B",
        "以下有关实验室用电的注意事项中，不正确的是：": "C",
        "使用电气设备时，由于维护不及时，当什么进入时可导致短路事故？": "A",
        "造成触电事故的因素是：": "A",
        "操作机床前要穿好工作服，袖口扣紧，上衣下摆不能敞开， 严禁戴手套，不得在开动的机床旁穿、脱换衣服，防止机器绞伤。": "正确",
        "触电时，不可人去拉（可用木棒把伤员挑开），应立即切断电源，然后先做人工呼吸，再做心脏按压，同时报120送医院进行处理。": "错误",
        "移动某些非固定安装的电气设备时(如电风扇，照明灯)，可以不必切断电源。": "错误",
        "学生进入实验室首先要了解实验室的安全注意事项。": "正确",
        "离开实验室前应检查门、窗、水龙头是否关好，通风设备、饮水设施、计算机、空调等是否已切断电源。": "正确",
        "机械温控冰箱可以存放易燃易爆的化学品。": "错误",
        "空调电源必须单独拉线，不得使用接线板。": "正确",
        "除非特殊需要并采取一定的安全保护措施，否则空调、计算机、饮水机等不得无人开机过夜。": "正确",
        "实验动物是进行生命科学研究基本的材料和对象，它的质量关系到研究结果和成功率。因此，实验动物应该来源于具备资质的单位。": "正确",
        "在扑灭电气火灾的明火时，用气体灭火器扑灭。": "正确",
        "扑救气体火灾切忌盲目扑灭火势，首先应切断火势蔓延途径，然后疏散火势中压力容器或受到火焰辐射热威胁的压力 容器，不能疏散的部署水枪进行冷却保护。": "正确",
        "当电气设备发生火灾后，如果可能应当先断电后灭火。": "正确",
        "对容易产生静电的场所，要保持空气潮湿；工作人员要穿防静电的衣服和鞋靴。?": "正确",
        "连接电气设备的开关需安装在火线上。": "正确",
        "声级计的传声器可自行拆卸。": "错误",
        "焊接时，必须穿戴好必要的防护用品，如工作服、手套、防护眼镜等。": "正确",
        "在熟睡时，听到火警信号后正确的做法是：1、用手试一试门是否热，如是冷的，可开门逃生；2、准备好湿毛巾；3、切勿随意跳楼，自制救生绳索后再设法安全着落；4、利用自然条件作为救生滑道。": "正确",
        "实验室的电源总闸没有必要每天离开时都关闭，只要关闭常用电气的电源即可。": "错误",
        "电源插座、接线板、电线的容量应满足电器功率的需要。": "正确",
        "所有的火灾刚开始时都是小火，随着火灾的发展输出的热量越大，火灾蔓延的速度和范围也愈大，所以扑灭初起火灾 最容易的。": "正确",
        "进行电气维修必须先关掉电源,在设置告知牌后，方可进行。": "正确",
        "地线和零线的作用相同。": "错误",
        "万用表电阻档可测量绝缘电阻。": "错误",
        "50毫安的工频电流就可以使人遭到致命电击。": "正确",
        "在进行电子线路板焊接后的剪脚工序时，剪脚面应背离身体特别是脸部，防止被剪下引脚弹伤。": "正确",
        "金属材料可以很好地屏蔽低频磁场。": "错误",
        "消除管线上的静电主要是做好屏蔽。": "错误",
        "漏电保护器既可用来保护人身安全，还可用来对低压系统或设备的绝缘状况起到监督作用；漏电保护器安装点以后的线路应是对地绝缘良好。": "正确",
        "在易燃、易爆、易灼烧及有静电发生的场所，可以使用化纤防护用品。": "错误",
        "在实验室同时使用多种电气设备时，其总用电量和分线用电量均应小于设计容量。": "正确",
        "短路是指电气线路中相线与相线，相线与零线或大地，在未通过负载或电阻很小的情况下相碰，造成电气回路中电流剧增的现象。": "正确",
        "在有爆炸和火灾危险场所使用手持式或移动式电动工具时，必须采用有防爆措施的电动工具。": "正确",
        "保险丝和空气开关可以有效地防止电气火灾。": "错误",
        "电动工具应定期检修。": "正确",
        "实验室禁止私拉乱接电线，实验过程中自制非标设备时，应报请实验室管理人员批准，然后请电气专业人员按照标准安全的连接。": "正确",
        "电动工具的电源引线必须保证接地可靠。": "正确",
        "打开含有高压变压器或电容器的电子仪器的盖子是危险的。": "正确",
        "电路保险丝熔断，短期内可以用铜丝或铁丝代替。": "错误",
        "在潮湿或高温或有导电灰尘的场所，实验时应该降低电压供电。": "正确",
        "机器仪表发生故障，或机器及动力装备等遇异状时，应该先关机，然后找有关人员前来检修,并设立警示牌。": "正确",
        "在钻床上工作时，为保护双手，可以戴手套进行工作。": "错误",
        "电路谐振时，电容的电压可以是电源电压的几倍。": "正确",
        "静电可以引起爆炸、电气绝缘和电子元器件击穿。": "正确",
        "短路会使短路处甚至整个电路过热，从而导致线路的绝缘层燃烧，引发火灾。": "正确",
        "火灾发生后，当所有的逃生线路被大火封锁时，应立即退回室内，用手电筒、挥舞衣物、呼叫等方式向窗外发送求救 信号，等待救援。": "正确",
        "同学发现宿舍楼的电闸箱起火，可以用楼内的消火栓灭火。": "错误",
        "灭火器材设置点附近不能堆放物品,以免影响灭火器的取用。": "正确",
        "发现火灾时，单位或个人应该先自救，当自救无效、火越着越大时，再拨打火警电话119。": "错误",
        "有“严禁烟火”警示牌的大楼和实验室，可不必配 置必要的消防、冲淋、洗眼、报警和逃生设施和有明显标志。": "错误",
        "使用手提灭火器时，拨掉保险销，握住胶管前端， 对准燃烧物根部用力压下压把，灭火剂喷出，左右扫射，就可灭火。": "正确",
        "实验大楼出现火情时千万不要乘电梯，因为电梯可能因停电或失控，同时又因“烟囱效应”，电梯井常常成为浓烟的 流通道。": "正确",
        "万一发生了火灾，不管是否是电气方面引起的，首先要想办法迅速切断火灾范围内的电源。": "正确",
        "实验室发生非火灾类事故，应立即报告单位负责人 和学校保卫处，设立警戒区并撤离无关人员，以减轻潜在危害。": "正确",
        "电气设备着火，首先必须采取的措施是灭火。": "错误",
        "液体着火时，应用灭火器灭火，不能用水扑救或其 它物品扑打。": "正确",
        "焊接场地在10米内，禁止堆放易燃和易爆物质。": "正确",
        "在钻床上工作时，如果钻头上缠有长铁屑，可用手拉断。": "错误",
        "任何电气设备在未验明无电时，一律认为有电，不能盲目触及。": "正确",
        "实验中遇到一般烫伤和烧伤，不要弄破水泡，在伤口处用95%的酒精轻涂伤口，涂上烫伤膏或涂一层凡士林油，再用纱布包扎。": "正确",
        "实验中遇到一般割伤，应立即取出伤口内的异物，保持伤口干净，并用酒精棉清除伤口周围的污物，涂上外伤膏或消炎粉。": "正确",
        "实施急救的顺序：若有呼吸心跳停止的，先行复苏，然后是止血、包扎、骨折固定或脱臼复位（固定）、搬运。": "正确",
        "剧毒品的标识是:": "正确",
        "电离辐射（放射性）的警告标识是:": "正确",
        "实验室安全与卫生工作应坚持“安全第一，预防为主”的原则。": "正确",
        "高校实验室科研教学活动中产生和排放的废气、废液、固体废物、噪声、放射性等污染物，应按环境保护行政主管部门的要求进行申报登记、收集、运输和处置。严禁把废气、废液、废渣和废弃化学品等污染物直接向外界排放。": "正确",
        "不得在冰箱、烘箱等加热、产热设备附近放置纸板、化学试剂、气体钢瓶等物品。": "正确",
        "因为实验需要，可以在实验室存放大量气体钢瓶。": "错误",
        "未经允许不得随意拆卸实验仪器和设备。": "正确",
        "可将食物储藏在实验室的冰箱或冷柜内。": "错误",
        "溅入口中已下咽的毒物，应根据毒物的性质服解毒剂，并立即送医院。": "正确",
        "实验室人员发生触电时，应迅速切断电源，将触电者上衣解开，取出口中异物，然后进性人工呼吸。当患者恢复呼吸时，应立即送医院。": "正确",
        "发现有人触电，应立即切断电源，不能直接拉触电者，应用木棒或其它绝缘物将人与带电体分离。": "正确",
        "燃烧必须具备可燃物、助燃物和点火源三大条件，缺一不可。因此，可以采取尽量隔离的方式来防止实验室火灾的发生。": "正确",
        "实验大楼出现火情时千万不要乘电梯，因为电梯可能因停电或失控，同时又因“烟囱效应”，电梯井常常成为浓烟的流通道。": "正确",
        "在室外灭火时，应站在上风位置。": "正确",
        "火灾发生后，当所有的逃生线路被大火封锁时，应立即退回室内，用手电筒、挥舞衣物、呼叫等方式向窗外发送求救信号，等待救援。": "正确",
        "踝关节韧带扭伤以后立即冷敷，加压包扎固定。": "正确",
        "轻微的肌肉拉伤或少量的肌肉纤维的断裂，应立即冷敷，局部加压包扎，抬高肢体。": "正确",
        "自然地形跑步时要注意做好缓冲动作，用全脚掌先着地，后蹬程度和前摆高度要小一些。": "错误",
        "从自己的实际情况出发，锻炼要循序渐进，不要急于求成，应做自己力所能及的动作。锻炼时间不宜过长，练习负荷不宜过重，以免过度疲劳或发生运动损伤。": "正确",
        "发生病原微生物被盗、被抢、丢失、泄漏，承运单位、护送人、保藏机构和实验室的设立单位未依照中华人民共和国卫生部《病原微生物实验室生物安全管理条例》的规定报告，造成传染病传播、流行或者其他严重后果的，由实验室的设立单位或者承运单位、保藏机构的上级主管部门对主要负责人、直接负责的主管人员和其他直接责任人员，依法给予撤职、开除的处分；构成犯罪的，依法追究刑事责任。": "正确",
        "抗菌剂不能够杀死微生物，只能抑制它们生长和繁殖。": "正确",
        "因实验室特殊要求，细胞培养房内用的气体钢瓶可不用固定，只要平时小心就可以。": "错误",
        "高校实验室发生安全事故的主要原因有：操作不慎、粗心大意、设施老化、缺少防护设施等。": "正确",
        "实验室电器发生火灾，在没有灭火器的情况下应先：": "C",
        "灭火器上的压力表用红、黄、绿三色表示灭火器的压力情况，当指针指在绿色区域表示：": "A",
        "储存可燃物资仓库的管理，必须执行国家有关（ ）": "A",
        "当遇到火灾时，要迅速向（ ）逃生。": "C",
        "公共场所安全出口的疏散门应（ ）。": "B",
        "泡沫灭火器不能用于扑救 （ ）火灾。": "C",
        "违反《中华人民共和国消防法》行为，构成犯罪的，应：": "B",
        "公安消防队救火（）": "C",
        "灭火的四种方法是：": "C",
        "我国消防工作的方针是：": "C",
        "楼内失火应( )": "A",
        "任何单位（ ）都有参加组织的灭火工作的义务。": "B",
        "在室外灭火时，应站在什么位置 ？": "A",
        "火灾初起阶段是扑救火灾( )的阶段。": "B",
        "学校教学楼应配备的灭火器型号是（ ）": "A",
        "公安消防人员在灭火过程中，应当（ ）。": "A",
        "扑救电气设备火灾时，不能用什么灭火器?": "C",
        "火灾中对人员威胁最大的是（ ）。": "B",
        "使用干燥箱和恒温箱，应注意的事项有：": "D",
        "实验中溅入口中已下咽的强碱，先饮用大量水，再服用：": "B",
        "化学强腐蚀烫、烧伤事故发生后，应       ，保持创伤面的洁净以待医务人员治疗。或用适合于消除这类化学药品的特种溶剂、溶液仔细洗涤烫、烧伤面。": "B",
        "有人触电时，使触电人员脱离电源的错误方法是：": "B",
        "以下止血方法中,哪种不作为首选应用?": "D",
        "加热和蒸馏有易燃试剂的实验时，不能用：": "B",
        "为避免误食有毒的化学药品，以下说法正确的是：": "C",
        "节假日期间，仍然需要进入实验室工作的师生，要严格遵守实验室操作规程，做实验时必须要有人在场，并且在实验完成离开时负责       ，锁好门窗，以防火灾和爆炸、溢水等事故。": "B",
        "实验室钥匙不得私自配置或给他人使用。钥匙的配发、管理由谁负责？": "A",
        "实验室内         。": "C",
        "实验室各种管理规章制度应该：": "A",
        "造成触电事故的因素是：": "A",
        "每次进行体育锻炼的时间一般以30分钟至多少小时为宜？": "A",
        "在体育锻炼时或体育锻炼后即刻，立即测10秒钟的心率和脉搏，就一般体育锻炼者来说，运动后即刻的心率最好不要超过多少次/10秒？": "B",
        "《中华人民共和国消防法》自（ ）起施行。": "B",
        "电线接地时，人体距离接地点越近，跨步电压越高；距离越远，跨步电压越低。一般情况下距离接地体多少，跨步电压可看成是零？": "B",
        "三相电闸闭合后或三相空气开关闭合后，三相电机嗡嗡响、不转或转速很慢。为什么？": "C",
        "引发电气火灾的初始原因：": "C",
        "自耦电源变压器的输出端指示电压为零时，表示：": "C",
        "下列哪些是预防电气火灾的基本措施？": "D",
        "在进行电子线路板焊接后的剪脚工序时应：": "A",
        "强电实验时，实验人员必须几人以上？": "B",
        "任何电气设备在未验明无电之前，一律认为：": "C",
        "车床开动以后：": "A",
        "实验大楼因出现火情发生浓烟已穿入实验室内时，以下哪种行为是正确的？": "A",
        "身上着火，最好的做法是：": "A",
        "进行照明设施的接电操作，应采取的防触电措施为：": "B"
    };


    // ------------------- 核心功能 -------------------

    /**
     * 答卷查看页：提取新题和错题
     */
    function extractNewQuestions() {
        const questionElements = document.querySelectorAll('div.shiti');
        let updates = {};
        let newCount = 0;
        let correctedCount = 0;

        questionElements.forEach(qElement => {
            const strongTag = qElement.querySelector('strong');
            if (!strongTag) return;

            // 1. 提取题目文本
            let questionText = strongTag.innerHTML.replace(/<br\s*\/?>/gi, ' ').replace(/<[^>]+>/g, '').replace(/\s+/g, ' ').trim();
            if (questionText.length < 5) return; // 忽略太短的无效内容

            const isWrong = qElement.querySelector('img[src*="wrong.gif"]');
            const isCorrect = qElement.querySelector('img[src*="correct.gif"]');
            let correctAnswerText = '';

            // 2. 提取正确答案
            const fullText = qElement.innerText;
            if (isWrong) {
                if (fullText.includes('标准答案：')) {
                    correctAnswerText = fullText.split('标准答案：')[1].trim().split(/\s/)[0];
                }
            } else if (isCorrect) {
                if (fullText.includes('你的答案：')) {
                    correctAnswerText = fullText.split('你的答案：')[1].trim().split(/\s/)[0];
                }
            }

            if (!correctAnswerText) return; // 无法提取答案则跳过

            // 3. 对比题库，找出新题或错题
            const existingAnswer = findBestMatch(questionText);
            if (!existingAnswer || existingAnswer.answer !== correctAnswerText) {
                if (existingAnswer) {
                    correctedCount++;
                    console.log(`[更正] 题目: "${questionText}", 原答案: "${existingAnswer.answer}", 正确答案: "${correctAnswerText}"`);
                } else {
                    newCount++;
                    console.log(`[新增] 题目: "${questionText}", 答案: "${correctAnswerText}"`);
                }
                updates[questionText] = correctAnswerText;
            }
        });

        // 4. 显示结果
        displayUpdates(updates, newCount, correctedCount);
    }

    /**
     * 在页面上显示提取结果
     */
    function displayUpdates(updates, newCount, correctedCount) {
        // 移除旧的显示框
        const oldBox = document.getElementById('question-update-box');
        if (oldBox) oldBox.remove();

        if (Object.keys(updates).length === 0) {
            alert('检查完成！\n\n您的题库貌似是最新的，没有发现新题目或错误答案。');
            return;
        }

        let formattedText = '';
        for (const q in updates) {
            // 将题目和答案中的双引号转义，以防止JSON格式错误
            const escapedQ = q.replace(/"/g, '\\"');
            const escapedA = updates[q].replace(/"/g, '\\"');
            formattedText += `        "${escapedQ}": "${escapedA}",\n`;
        }

        const container = document.createElement('div');
        container.id = 'question-update-box';
        container.style.cssText = 'position:fixed; top:100px; right:20px; z-index:10000; width:450px; background-color:white; border:1px solid #ccc; box-shadow:0 0 10px rgba(0,0,0,0.2); padding:15px; border-radius:8px;';

        const title = document.createElement('h3');
        title.textContent = `发现 ${newCount} 个新题, ${correctedCount} 个错题`;
        title.style.margin = '0 0 10px 0';
        title.style.fontSize = '16px';

        const description = document.createElement('p');
        description.textContent = '请复制以下内容，并替换您脚本中的旧题目：';
        description.style.margin = '0 0 10px 0';
        description.style.fontSize = '14px';

        const textArea = document.createElement('textarea');
        textArea.value = formattedText;
        textArea.style.cssText = 'width:98%; height:200px; font-size:12px; font-family:monospace;';

        const copyButton = document.createElement('button');
        copyButton.textContent = '复制到剪贴板';
        copyButton.style.cssText = 'padding:8px 12px; background-color:#28a745; color:white; border:none; border-radius:5px; cursor:pointer; margin-top:10px;';
        copyButton.onclick = () => {
            GM_setClipboard(textArea.value);
            copyButton.textContent = '已复制！';
            setTimeout(() => { copyButton.textContent = '复制到剪贴板'; }, 2000);
        };

        const closeButton = document.createElement('button');
        closeButton.textContent = '关闭';
        closeButton.style.cssText = 'padding:8px 12px; background-color:#6c757d; color:white; border:none; border-radius:5px; cursor:pointer; margin-left:10px;';
        closeButton.onclick = () => container.remove();

        container.appendChild(title);
        container.appendChild(description);
        container.appendChild(textArea);
        container.appendChild(document.createElement('br'));
        container.appendChild(copyButton);
        container.appendChild(closeButton);

        document.body.appendChild(container);
    }


    /**
     * 答题页：主函数
     */
    function autoAnswer() {
        // ... (自动答题逻辑保持不变)
        const questionElements = document.querySelectorAll('div.shiti');
        let foundCount = 0; let notFoundCount = 0;
        if (questionElements.length === 0) { alert('当前页面未找到任何题目！请确认您在答题页面。'); return; }
        questionElements.forEach((qElement) => {
            const oldDisplay = qElement.querySelector('.similar-question-display');
            if (oldDisplay) oldDisplay.remove();
            const questionTitleElement = qElement.querySelector('h3');
            if (!questionTitleElement) return;
            let questionText = questionTitleElement.innerHTML.replace(/^\d+、/, '').replace(/<[^>]+>/g, '').trim();
            const result = findBestMatch(questionText, true);
            if (result) {
                foundCount++;
                const { answer, bestMatchText } = result;
                const isTrueFalse = qElement.querySelector('ul.xuanxiang_panduan');
                if (isTrueFalse) {
                    const targetValue = (answer === '正确') ? '1' : '0';
                    const radio = qElement.querySelector(`input[name^="ti_"][value="${targetValue}"]`);
                    if (radio) radio.checked = true;
                } else {
                    const options = qElement.querySelectorAll('ul li input[type="radio"]');
                    const optionMap = ['A', 'B', 'C', 'D'];
                    const answerIndex = optionMap.indexOf(answer);
                    if (answerIndex !== -1 && options[answerIndex]) { options[answerIndex].checked = true; }
                }
                const displayDiv = document.createElement('div');
                displayDiv.className = 'similar-question-display';
                displayDiv.style.cssText = 'padding:8px 15px; font-size:12px; color:#333; background-color:#f0f0f0; border:1px solid #ddd; border-radius:4px; margin-top:10px; font-style:italic;';
                displayDiv.innerHTML = `<strong>题库匹配:</strong> ${bestMatchText}`;
                const optionsList = qElement.querySelector('ul');
                if (optionsList) { optionsList.insertAdjacentElement('afterend', displayDiv); }
                else { qElement.appendChild(displayDiv); }
            } else {
                notFoundCount++;
                console.warn(`题库中未找到题目: "${questionText}"`);
            }
        });
        alert(`答题完成！\n\n成功匹配 ${foundCount} 题，未匹配 ${notFoundCount} 题。\n请检查并手动完成未匹配的题目。`);
    }

    /**
     * 在题库中查找最匹配的答案
     * @param {string} text - 页面上的题目文本
     * @param {boolean} log - 是否打印日志
     * @returns {object|null} - 包含答案和最佳匹配文本的对象，或null
     */
    function findBestMatch(text, log = false) {
        let bestMatch = { question: null, answer: null, similarity: 0 };
        const SIMILARITY_THRESHOLD = 80;
        for (const key in questionBank) {
            const similarity = calculateSimilarity(text, key);
            if (similarity > bestMatch.similarity) {
                bestMatch = { question: key, answer: questionBank[key], similarity: similarity };
            }
        }
        if (bestMatch.similarity >= SIMILARITY_THRESHOLD) {
            if (log) console.log(`匹配成功 (相似度: ${bestMatch.similarity.toFixed(2)}%): "${text}" -> "${bestMatch.question}"`);
            return { answer: bestMatch.answer, bestMatchText: bestMatch.question };
        }
        return null;
    }

    /**
     * 计算字符串相似度
     */
    function calculateSimilarity(s1, s2) {
        let longer = s1, shorter = s2;
        if (s1.length < s2.length) { longer = s2; shorter = s1; }
        let longerLength = longer.length;
        if (longerLength === 0) return 100.0;
        return (1.0 - levenshteinDistance(longer, shorter) / longerLength) * 100;
    }

    /**
     * Levenshtein距离算法
     */
    function levenshteinDistance(s1, s2) {
        const costs = new Array(s2.length + 1);
        for (let i = 0; i <= s1.length; i++) {
            let lastValue = i;
            for (let j = 0; j <= s2.length; j++) {
                if (i === 0) costs[j] = j;
                else if (j > 0) {
                    let newValue = costs[j - 1];
                    if (s1.charAt(i - 1) !== s2.charAt(j - 1)) newValue = Math.min(Math.min(newValue, lastValue), costs[j]) + 1;
                    costs[j - 1] = lastValue;
                    lastValue = newValue;
                }
            }
            if (i > 0) costs[s2.length] = lastValue;
        }
        return costs[s2.length];
    }


    /**
     * 插入功能按钮
     */
    function insertButton(text, onClickHandler, color = '#007BFF') {
        const button = document.createElement('button');
        button.textContent = text;
        button.style.cssText = `position:fixed; top:100px; right:20px; z-index:9999; padding:10px 15px; background-color:${color}; color:white; border:none; border-radius:5px; cursor:pointer; font-size:16px; box-shadow:0 2px 5px rgba(0,0,0,0.2);`;
        button.addEventListener('click', onClickHandler);
        document.body.appendChild(button);
    }

    // --- 脚本入口：根据页面标题判断加载哪个功能 ---
    window.addEventListener('load', () => {
        const pageTitle = document.querySelector('.head-title h2');
        if (pageTitle) {
            if (pageTitle.innerText.includes('在线考试')) {
                insertButton('自动答题 (模糊匹配)', autoAnswer, '#007BFF');
                console.log('【安全考试脚本】: 已加载“自动答题”功能。');
            } else if (pageTitle.innerText.includes('答卷查看')) {
                insertButton('提取新题/错题', extractNewQuestions, '#17a2b8');
                console.log('【安全考试脚本】: 已加载“提取新题/错题”功能。');
            }
        }
    });

})();